С_И_С_Т_Е_М_А  И_М_Е_Н_О_В_А_Н_И_Я  Ф_А_Й_Л_О_В_О_Г_О  П_Р_Е_Д_С_Т_А_В_Л_Е_Н_И_Я  Ф_О_Т_О_Г_Р_А_Ф_И_Й


Версия: 0.1.1


————————————————


П Р И Ч И Н Ы


В среде управляющих цифровых систем, основанных на неповторимости имён файлов, возникает необходимость:
1. в устранении вероятности появления файлов фотографий с одинаковыми именами, т. к. в этих случаях возникает угроза их потери из-за перезаписи;
2. в устранении несовместимости систем именования отдельных подмножеств файлового представления фотографий, т. к. в этих случаях снижается удобство и продуктивность их совместного использования и обслуживания.


Н А П Р А В Л Е Н И Е  Р Е Ш Е Н И Я


Создание единой системы именования файлового представления фотографий, которая полностью или в достаточной степени исключает возникновение одноимённых файлов.


Т Р Е Б О В А Н И Я  К  Р Е Ш Е Н И Ю


Решение должно стремиться к наибольшей свободе для условий создания, использования и обслуживания файлового представления фотографий.


Р Е Ш Е Н И Е


ОБЩИЕ ПОЛОЖЕНИЯ


• Система основана на хронологии и использовании значений определённых метаданных для именования.
• Система не строгая и только основа, при необходимости или желании допустимы отступления с сохранением сути под собственную ответственность пользователя.
• Условия съёмки предполагаются желательно в пределах одного часового пояса на планете Земля.
• Значения метаданных для именования берутся из первоначальных файлов файлового представления фотографий — raw-файлов.
• Все raw-файлы должны иметь по крайней мере достаточный для системы состав достоверных первоначальных метаданных.
• Программным инструментом для воплощения системы является приложение ExifTool от Фила Харви (Phil Harvey).

https://owl.phy.queensu.ca/~phil/exiftool

• Предполагается, что пользователь имеет по крайней мере начальный уровень понимания ExifTool и Perl-совместимых регулярных выражений.
• Из-за разнообразия состава и содержимого метаданных от разных производителей оборудования, предложенные здесь ExifTool-команды отражают лишь частный случай, и предполагается, что, возможно, появится необходимость приспособления их с сохранением сути под свои условия и предпочтения.
• Должна быть промежуточная папка для сбора raw-файлов перед их упорядочиванием и использованием:

НОСИТЕЛЬ\ПРОМЕЖУТОЧНАЯ_ПАПКА\

• Результирующая структура папок и файлов должна быть в корне носителя, чтобы с большей вероятностью уложиться в ограничение на длину полного имени файла в различных управляющих цифровых системах; например, Windows предоставляет максимум 260 символов для полного имени.
• Используются только латиница, цифры и п́одчерк:

a-Z, 0-9, _

Это позволяет сделать имена папок и файлов единообразными для удобства их визуального восприятия, особенно людьми с плохим зрением, а также позволяет упростить написание собственных скриптов, оперирующих этими именами.
• Имена и иерархия папок основываются на хронологии внутрикамерных дат создания raw-файлов, т. к. она более чем другие параметры предрасположена к однозначности и наглядности совместно:

НОСИТЕЛЬ\ГГГГ\ГГГГММДД\ФАЙЛЫ

• Для системы используются только характерные и в совокупности достаточные для относительной глобальной уникальности метаданные:

20190718 — дата.
032000 — время.
f0300 или b0230 — часовой пояс (f — forward (вперёд), b — backward (назад)).
CanonEOS5DMarkIV — модель камеры (этим можно пренебречь и использовать только серийный номер камеры, вероятность совпадения которого с серийными номерами от других производителей ничтожна).
163066096287 — серийный номер камеры.
IMG_0024 — первоначальное имя raw-файла (некоторые камеры пишут в метаданные номер raw-файла, например, FileNumber:100-0024 в IMG_0024.cr2, который также можно использовать в качестве первоначального имени, заменив дефис на п́одчёрк или убрав вовсе).
v02 — версия результата для производных от raw-файлов (v — version (версия)).

• Некоторые камеры могут не записывать необходимые метаданные, тогда эти метаданные перед именованием пользователь должен добавить вручную.


ПОРЯДОК ДЕЙСТВИЙ


• Сбор raw-файлов в промежуточной папке, желательно в её корне.
• Удаление ненужных raw-файлов.
• Занесение в метаданные raw-файлов информации об авторских правах.

exiftool -progress: -progress -r -EXIF:Artist="Author Name" -EXIF:Copyright="Author Name" -IPTC:By-Line="Author Name" -IPTC:CopyrightNotice="Author Name" -XMP:Creator="Author Name" -XMP:Rights="Author Name" -ext cr2 .

• Занесение исходного имени raw-файлов в их метаданные.

exiftool -progress: -progress -r "-IPTC:ObjectName<Filename" "-XMP:PreservedFileName<Filename" "-XMP:CameraFilename<Filename" "-XMP:OriginalFileName<Filename" "-XMP:RawFileName<Filename" -ext cr2 .

• Если в метаданных raw-файлов отсутствует информация о часовом поясе, то она добавляется вручную.

exiftool -progress: -progress -r -EXIF:OffsetTime="+03:00" -EXIF:OffsetTimeOriginal="+03:00" -EXIF:OffsetTimeDigitized="+03:00" -ext cr2 .

• Распределение с переименованием оставшихся raw-файлов по структуре папок.

exiftool -progress: -progress -r -d "%Y/%Y%m%d/%Y%m%d_%H%M%S" "-FileName<D:\${DateTimeOriginal}_${OffsetTimeOriginal;s/\+/f/;s/-/b/;s/://}_${Model;s/ //g}_${SerialNumber}_${FileName}" -ext cr2 .

…D:\… — буква диска задаётся вручную.

• Создание производных от raw-файлов (psd, jpg…). Производные создаются в той же папке, что и raw-файлы, а также получают уточнённое имя при необходимости, например, с добавлением версии.


П Р И М Е Р Ы


ПОЛНОЕ СООТВЕТСТВИЕ СИСТЕМЕ


D:\2019\20190718\20190718_032000_f0300_CanonEOS5DMarkIV_163066096287_IMG_0024.cr2
D:\2019\20190718\20190718_032000_f0300_CanonEOS5DMarkIV_163066096287_IMG_0024.psd
D:\2019\20190718\20190718_032000_f0300_CanonEOS5DMarkIV_163066096287_IMG_0024_v02.psd
D:\2019\20190718\20190718_032000_f0300_CanonEOS5DMarkIV_163066096287_IMG_0024.jpg
D:\2019\20190718\20190718_032000_f0300_CanonEOS5DMarkIV_163066096287_IMG_0024_v02.jpg


ПОЛЬЗОВАТЕЛЬСКИЕ ОТСТУПЛЕНИЯ


D:\2019\20190718\20190718_032000_f0300_163066096287_IMG_0024.cr2
D:\2019\20190718\20190718_032000_f0300_163066096287_IMG_0024_v02.jpg
D:\2019\20190718_Minsk\20190718_032000_f0300_CanonEOS5DMarkIV163066096287IMG0024.cr2
D:\2019\20190718_Photography_workshop\20190718032000_f0300163066096287IMG0024.cr2
D:\2019\20190718\20190718_032000f0300_IMG0024.cr2
D:\2019\20190718\20190718_IMG0024.cr2 (это один из вариантов с низкой уникальностью имени, который не рекомендуется)


————————————————


Свёрстано по Текстазису — textasis.afoteris.com.
© Андрей Коржиц, Елена Абражевич, 2019–∞
gmail: andreikorzhyts